### 

  
>这个系列我暂时还没一个完整的规划，就先不做一个总纲了。  
这里所说的代码，是广义上的，包括所有可被管理起来的智力资产：c/c++ code, perl/python/ruby/shell script, template, www files, config files, binaries ...。从另一个维度上说，包括开发环境与部署环境下的所有智力资产。  
当然，这里面最重要的，当属c/c++ code。所以，我先讲它的一个基本设施：Makefile。  
目前我们所用的Makefile，可以说是最原始的那种，存在比较多的问题。  
1.  最重要的一点：不能自动建立依赖关系，某个头文件被修改，不会自动重新编译。这是我以前用crawler时遇到的情况，有时运行出core了， 有经验人士给我的建议就是：先make clean一下，然后再make
2.  将lib作为object进行连接而不是使用-l (小写的L)，也就是使用 g++ -o main main.o dir/libutil.a而不是g++ -o main main.o -l util -L dir。这导致的问题是连接出来的可执行文件比较大，里面包含了很多不必要的object。
3.  在Makefile中使用synlib同步头文件按和lib，这个是我的个人观点，可能很多人不同意，我就不做评论了。这点和我们目前所用的大 环境有关，我放到以后再说。
4.  CXXFLAGS不向sub-make传递，使得只能在所有Makefile中写入同样的CXXFLAGS，但如果要enforce a new policy globally，比如从-ggdb 变成-ggdb -O2，就有点力不从心了。这点我是在这几天才深刻体会到。比如在crawler中不能使用-O2选项（否则从index页parse 不出数据），但前两天黄浩说通过使用-O2选项，接卸json的速度提高了10倍。在同样的一个大环境下要使用两套不同的flag，原来的方式就有些不灵 活了。当然这点也和我们的大环境有关，简单的Makefile其实也能解决这点。
5.  在Makefile中显示指定所有待编译的.cpp，这点问题不大，但如果默认所有，然后通过EXCELUDES进行排除，应该可以减少击键 数，并且当增加新的.cpp时，不用修改Makefile
6.  Makefile风格不统一。其实说这么多点，除了第一点，都是些瑕疵，但如果能改进，何乐而不为。

  
下面入正题，针对这些问题，我写了一个common makefile，它能够  
1.  自动建立依赖，修改任何一个被依赖的文件(.cpp, .h甚至.a)，都会引起重新编译（当然只编译需要的部分）
2.  自动递归subdirs (严格说其实parent dir / brother dir也可以)，并能传入特定flags，便于enforce the same policy among all codes.
3.  SOURCES可以指定目录而不用非得是.cpp，并可通过EXCLUDES排除指定文件
4.  能够编译lib和binary
5.  自动建立clean, veryclean等target
6.  可以指定子目录使用特定的Makefile (非 make -f -C)，见下面3个例子
7.  自动判定os的bit version (32/64)，并依赖不同的lib，这点对我以后要说的将lib也通过版本管理系统管理起来比较重要，因为我们必须处理32位和64位lib并存的情 况，这点也见例子3 (BITS)目前不支持的是一份代码，编译多个库，每个库包含不同的文件。其实这也可以实现，但我还没发现这方面的需求。但可以编译多个binaries。

  
这个Makefile其实完全可以模拟automake那一套，但我觉得没必要，够用就行了。而经过我的实践证明（包括所有 ticket/train search, ticketcrawler以及他们依赖的所有库：util, WordBreak, DownloadCentre等），这应该可以够用了  
commonmake的最新代码见git@60.28.205.235:kxenv.git/commonmake.git，包括一个完整的 Makefile.template，里面示例其完整用法，实际使用时大部分取其默认值，只需将要更改部分抽取出来形成Makefile就可以了。<span class="nobr"><a href="http://bear:8081/download/attachments/1572976/commonmake.tar?version=1&modificationDate=1207814552000">commonmake.tar<sup><img align="absmiddle" alt="" border="0" class="rendericon" height="7" src="http://bear:8081/images/icons/link_attachment_7.gif" width="7" /></sup></a></span>是较早的一 个snapshot.  
说这么多不如举几个简单的例子。  
<div class="panel" style="border-width: 1px;">
  <div class="panelHeader" style="border-bottom-width: 1px;">
    <b>SearchHelper的Makefile</b>
  </div>
  
  <div class="panelContent">
    SearchHelper有以下子目录：SSBaseLib SSTemplateLib SSRelateWords SSADHelperLib SSResultHelperLib<br /> 原来共有6个Makefile(每个子目录以及SearchHelper目录)，而下面是我用commonmake的只一个makefile的等价品<br /> <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent">
        <pre class="code-java">ENVDIR=../../..
LIBNAME := ../lib/libSearchHelper.a
SOURCES := SSBaseLib SSTemplateLib SSRelateWords SSADHelperLib SSResultHelperLib
INCLUDES=.. ../include \
         include SSResultHelperLib \
         $(addprefix $(ENVDIR)/, util include) \
         $(addprefix ../../, WmlSupport/include AdSupport/include UniPortable/include)
all : lib
CMFDIR=$(ENVDIR)/commonmake
include $(CMFDIR)/kxcommon.mk
</pre>
      </div>
    </div>
  </div>
</div>

<div class="panel" style="border-width: 1px;">
  <div class="panelHeader" style="border-bottom-width: 1px;">
    <b>util的Makefile</b>
  </div>
  
  <div class="panelContent">
    <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent">
        <pre class="code-java">ENVDIR := ..
BINNAMES := test converttest
LIBNAME := $(ENVDIR)/lib/libutil.a
SOURCES := SAXParser .
EXCLUDES := converttest.cpp \
    setup.cpp glbayesfilter.cpp \
    des.cpp hrutil.cpp \
    $(addprefix SAXParser/, wmltxtparser.cpp formparser.cpp positivenegparser.cpp rssparser.cpp trackbackparser.cpp)
INCLUDES=. $(ENVDIR) $(addprefix $(ENVDIR)/include/, . ImageMagick)
LIBS = cutword \
       pthread mysqlclient \
       $(addsuffix -1_33_1-$(BITS), boost_regex-gcc boost_serialization-gcc boost_date_time-gcc-mt)
LDFLAGS := `Magick++-config --ldflags --libs`
all : lib
CMFDIR=$(ENVDIR)/commonmake
include $(CMFDIR)/kxcommon.mk
</pre>
      </div>
    </div>
  </div>
</div>

<div class="panel" style="border-width: 1px;">
  <div class="panelHeader" style="border-bottom-width: 1px;">
    <b>ticketsearch的Makefile</b>
  </div>
  
  <div class="panelContent">
    <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent">
        <pre class="code-java">ENVDIR=../..
BINNAMES := main searchmonitor keep
SOURCES=.
SUBDIRS = $(addprefix $(ENVDIR)/, WordBreak util) \
          $(addprefix ../, $(addsuffix /source, UniPortable UniChannels WmlSupport AdSupport)) \
          SearchHelper
SUBDIRMFS=Makefile.common
INCLUDES=. include include/sessionclient \
         $(addprefix $(ENVDIR)/include/, . boost tinyxml) \
         $(addprefix $(ENVDIR)/, WordBreak util) \
         $(addprefix ../, $(addsuffix /include, UniPortable WmlSupport AdSupport)) \
         SearchHelper/include SearchHelper/SSResultHelperLib
LIBDIRS := lib $(ENVDIR)/lib
LIBS=SearchHelper \
     WmlSupport AdSupport UniPortable UniChannels \
     sessionclient koowautil_search \
     util cutword \
     tinyxml boost_regex-gcc-1_33_1-$(BITS) log4cxx pthread
CMFDIR=$(ENVDIR)/commonmake
include $(CMFDIR)/kxcommon.mk
bindir = ../ticketsearch.bin
.PHONY : install
install : bin
    @echo install $(BINNAMES)
    @cp -fv main $(bindir)/search
    @cp -fv keep searchmonitor $(bindir)/
</pre>
      </div>
    </div>
    
    <div class="panelMacro">
      <table class="noteMacro">
        <colgroup><col width="24"></col><col></col></colgroup><tbody>
          <tr>
            <td valign="top">
              <img align="absmiddle" alt="" border="0" height="16" src="http://bear:8081/images/icons/emoticons/warning.gif" width="16" />
            </td>
            
            <td>
              <ol>
                <li>
                  我指定子目录使用Makefile.common而不是Makefile，这样可做到不修改原来Makefile，保持和原来那套的兼容。
                </li>
                <li>
                  BITS 自动识别 os bit version。注意这里BITS不是一个符号，而是一个真正的变量，其在kxcommon.mk里赋值
                </li>
              </ol>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>e="font-family: 宋体;">是纯</span></span><span lang="EN-US">c</span><span style="font-family: 宋体;"><span style="font-family: 宋体;">写的，有</span></span><span lang="EN-US">php, perl, python, ruby, java, c#, php</span><span style="font-family: 宋体;"><span style="font-family: 宋体;">等扩展，绝对是高性能</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><br /> smarty, mako, jinja</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">是编译形（非解释形）模板，性能也不错</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><br /> </span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">表达力方面</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">mako, jinja</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">支持模板</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">include</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">与模板继承</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">, </span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">支持</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">filter</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，功能应该算最强；</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"> smarty</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">和</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">clearsilver</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">支持模板</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">include</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，但不支持继承。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">Smarty</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">也支持</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">filter</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><br /> </span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">表达力来说，我认为</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">mako, jinja > smarty > clearsilver</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">但就我目前的观察，</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">clearsilver</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">完全够用了，而且它开源，我们可以根据需要在上面做修改</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><br /> </span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">（模板继承对实现代码复用，特别以尽量少的模板保持统一的界面风格，有相当大好处：</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><a href="http://wsgiarea.pocoo.org/jinja/docs/inheritance.html" title="http://wsgiarea.pocoo.org/jinja/docs/inheritance.html">http://wsgiarea.pocoo.org/jinja/docs/inheritance.html</a></span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">）</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal" style="margin-left: 18pt; mso-list: l0 level1 lfo4; text-indent: -18pt;">
    <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><span style="mso-list: Ignore;">3.<span style="font-family: 'Times New Roman'; font-size: xx-small;"><span style="font: 7pt 'Times New Roman';">       </span></span></span></span></span><span style="font-family: 宋体;"><span style="font-family: 宋体;">简单不需要额外代码的转换：<b><span style="font-weight: bold;">数据文件</span></b></span></span><b><span lang="EN-US" style="font-weight: bold;">+</span></b><b><span style="font-family: 宋体;"><span style="font-family: 宋体; font-weight: bold;">模板</span></span><span lang="EN-US"> => output</span></b><span lang="EN-US"> </span><span style="font-family: 宋体;"><span style="font-family: 宋体;">（</span></span><b><span lang="EN-US" style="font-weight: bold;">xslt/xml</span></b><span lang="EN-US">: </span><span style="font-family: 宋体;"><span style="font-family: 宋体;">浏览器，</span></span> <b><span lang="EN-US" style="font-weight: bold;">clearsilver/hdf</span></b><span lang="EN-US">: apahce cgi</span><span style="font-family: 宋体;"><span style="font-family: 宋体;">）</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><br /> </span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">只需和</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">定好了数据文件的格式，</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">编写模板后就能不需额外编码直接看到转换后的输出</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">总之，<b><span style="font-weight: bold;">对于模板语言的推荐</span></b></span></span><b><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt; font-weight: bold;"><o:p></o:p></span></span></b>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">如果所有模块强制要求必须全部经过</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">php</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">开发，而且</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">php</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的数据获取多是通过</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">mysql</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，强烈建议用</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">smarty<o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">同样的需求，对</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">python</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的话</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">mako, jinja, </span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">都不错</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">但是，如果不是所有模块不都经过</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">php</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，或者</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">php</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的获取的数据多是由后台程序生成的，用</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">smarty</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">就不一定是最好的。我们必须把后台生成数据的代价也考虑进去。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <br />
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">对我们目前这种架构，前台</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">php</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，后台</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">c/c++</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的情况<b><span style="font-weight: bold;">，我建议用</span></b></span></span><b><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt; font-weight: bold;">clearsilver</span></span></b><b><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt; font-weight: bold;">，理由如下：</span></span></b><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal" style="margin-left: 18pt; mso-list: l2 level1 lfo6; text-indent: -18pt;">
    <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><span style="mso-list: Ignore;">1.<span style="font-family: 'Times New Roman'; font-size: xx-small;"><span style="font: 7pt 'Times New Roman';">       </span></span></span></span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">以</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">hdf</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">为交换格式，</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">php</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">前台可以对接收到的数据不作分析，直接</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">populate</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">到模板中去，可通过一个通用的</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">php</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">实现所有模块的处理。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal" style="margin-left: 18pt; mso-list: l2 level1 lfo6; text-indent: -18pt;">
    <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><span style="mso-list: Ignore;">2.<span style="font-family: 'Times New Roman'; font-size: xx-small;"><span style="font: 7pt 'Times New Roman';">       </span></span></span></span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">即使前台不用</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">php</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，而采用其他语言，同样不用分析后台传过来的数据，直接</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">forward</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">给模板</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal" style="margin-left: 18pt; mso-list: l2 level1 lfo6; text-indent: -18pt;">
    <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><span style="mso-list: Ignore;">3.<span style="font-family: 'Times New Roman'; font-size: xx-small;"><span style="font: 7pt 'Times New Roman';">       </span></span></span></span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">如果没有前台，而改由后台（如</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">cgi</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">）直接生成</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">html</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">输出，后台程序也几乎不用改动</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">(</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">最多加两行</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">load template</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的代码</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">)<o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <br />
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">内部数据交换格式方面：我认为</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">json</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">hdf</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">都是比</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">xml</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">更好的选择。即使不用</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">clearsilver</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，我认为</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">json</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">也比</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">xml</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">更适合。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">Json</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">可直接在</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">javascript</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">中还原为对象，很方便</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">javascript</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">使用。但</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">json</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">c</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">api</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">我没看过，不知道是否容易输出，但想来不会比</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">xml</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">难。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <br />
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">如果有的模块对外确实要提供</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">rss</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，那么可以使用一个通用的模块单独做一个</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">rss</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的输出。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <br />
  </div>
  
  <div class="MsoNormal">
    <b><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt; font-weight: bold;">Ue</span></span></b><b><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt; font-weight: bold;">和程序分离的难点</span></span></b><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">在于：</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">一点也不懂程序，书写模板来不是那么容易。这点我认为可以通过培训一个</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">人员来专门套模板来解决。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <b><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt; font-weight: bold;">开发流程方面</span></span></b><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">：我所设想是这样的</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">1. </span></span><b><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt; font-weight: bold;">不动文件格式下的微小界面修改</span></span></b><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><br />          pm</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">需求</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"> ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">修改</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">提交测试地址</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">测试人员测试通过</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">上传</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">cvs</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">上线人员上线</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">2. </span></span><b><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt; font-weight: bold;">需要改动数据文件格式的大的界面修改</span></span></b><b><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt; font-weight: bold;">/</span></span></b><b><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt; font-weight: bold;">或新的界面</span></span></b><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">         <b><span style="font-weight: bold;">UE:  </span></b>Pm</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">需求</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">修改，套模板人员与程序协商数据格式，套界面，自己测试通过</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">上传</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">cvs<o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">         <b><span style="font-weight: bold;">RD:</span></b> Pm</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">需求</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">与</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">协商数据格式</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">修改程序</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"> cvs update</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">新提交的模板</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">—></span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">提交测试人员测试并通过</span></span><span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">上传</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">cvs-><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal" style="text-indent: 21pt;">
    <span style="font-family: Wingdings; font-size: xx-small;"><span lang="EN-US" style="font-family: Wingdings; font-size: 9pt;">à</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">上线人员上线</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal" style="text-indent: 21pt;">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">如果要更规范：建议有一个<b><span style="font-weight: bold;">通用的和线上环境类似的测试环境</span></b>，所有上线前的正规测试都应提交到这个环境进行<b><span style="font-weight: bold;">。并有相应的上线人员</span></b>，在测试通过后，通过测试环境的数据通过脚本自动实现备份和上线</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
  
  <div class="MsoNormal">
    <span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">上面两点的关键是</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">: UE</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">和程序共用一个</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">cvs</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">可以和</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">rd</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">人员直接交互，而不是像目前这样通过</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">email</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">传递界面修改，</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">和</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">rd</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">之间不相往来，以</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">pm</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">为媒介。不使用同一份代码的后果是：无法直接在</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">提供过来的文件上直接套模板，而需要找出</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的修改部分，由</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">rd</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">将修改部分加入</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">rd</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">这边维护的模板。这造成很多冗余工作量。特别是</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">css</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">这块，</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">ue</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">给的</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">css</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">的</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">class name</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">很不规范</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">(</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">向</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">coll1, col2</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">之类</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">)</span></span><span style="font-family: 宋体; font-size: xx-small;"><span style="font-family: 宋体; font-size: 9pt;">，造成了套模板的更大负担。</span></span><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"><o:p></o:p></span></span>
  </div>
</div>ont-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">BINNAMES := main searchmonitor keep<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">SOURCES=.<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">SUBDIRS = $(addprefix $(ENVDIR)/, WordBreak util) \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">          $(addprefix ../, $(addsuffix /source, UniPortable UniChannels WmlSupport AdSupport)) \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">          SearchHelper<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <b><span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt; font-weight: bold;">SUBDIRMFS=Makefile.common<o:p></o:p></span></span></b>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <br />
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">INCLUDES=. include include/sessionclient \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">         $(addprefix $(ENVDIR)/include/, . boost tinyxml) \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">         $(addprefix $(ENVDIR)/, WordBreak util) \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">         $(addprefix ../, $(addsuffix /include, UniPortable WmlSupport AdSupport)) \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">         SearchHelper/include SearchHelper/SSResultHelperLib<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">LIBDIRS := lib $(ENVDIR)/lib<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">LIBS=SearchHelper \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">     WmlSupport AdSupport UniPortable UniChannels \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">     sessionclient koowautil_search \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">     util cutword \<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">     tinyxml boost_regex-gcc-1_33_1-<b><span style="font-weight: bold;">$(BITS)</span></b> log4cxx pthread<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <br />
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">CMFDIR=$(ENVDIR)/commonmake<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">include $(CMFDIR)/kxcommon.mk<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <br />
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">bindir = ../ticketsearch.bin<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">.PHONY : install<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">install : bin<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">    @echo install $(BINNAMES)<o:p></o:p></span></span>
</div>

<div class="MsoNormal" style="margin-left: 18pt;">
  <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;">    @cp -fv main $(bindir)/search</span></span><br /> <span style="font-family: Arial; font-size: xx-small;"><span lang="EN-US" style="font-family: Arial; font-size: 9pt;"></span></span><span class="Apple-style-span" style="font-family: Arial; font-size: 12px;">    @cp -fv keep searchmonitor $(bindir)/</span><br /> <span class="Apple-style-span" style="font-family: Arial; font-size: 12px;"><br /> </span><br /> <span class="Apple-style-span" style="font-family: Arial; font-size: 12px;"></span><br /> <img align="absmiddle" alt="" border="0" height="16" src="http://bear:8081/images/icons/emoticons/warning.gif" width="16" /><ol>
    <li>
      我指定子目录使用Makefile.common而不是Makefile，这样可做到不修改原来Makefile，保持和原来那套的兼容。
    </li>
    <li>
      BITS 自动识别 os bit version。注意这里BITS不是一个符号，而是一个真正的变量，其在kxcommon.mk里赋值
    </li>
  </ol>
</div>

<div class="MsoNormal" style="margin-left: 18pt; text-indent: 18pt;">
  <span class="Apple-style-span" style="font-family: Arial; font-size: small;"><span class="Apple-style-span" style="font-size: 12px;"><br /> </span></span>
</div>